<html>

<head>
	<script type="text/javascript" src="external/ocanvas-2.8.1.js"></script>
	<script type="text/javascript" src="external/underscore.js"></script>

	<script type="text/javascript" src="world.js"></script>
	<script type="text/javascript" src="agent.js"></script>
	<script type="text/javascript" src="simulation.js"></script>

<script type="text/javascript">

// Add GUI for steps
// create remove agent
// complete game of life
// create choosing behavior between traits like in article

function processInput() {
	var input = document.getElementById('input').value;
	document.getElementById('output').value = input;
}


oCanvas.domReady( function() {
	var canvas = oCanvas.create({ canvas: "#myCanvas", background: "#222" });

	var world = new World(canvas, 
		{
			AGENT_SIZE: 1
		} //
	);	


	var randStartConf = function(n,squareSize) {
		var ret = [];
		for (var i = 0; i < n; i++) {
			ret.push(new Agent(
							squareSize-Math.floor(Math.random()*squareSize*2),
							squareSize-Math.floor(Math.random()*squareSize*2)
							)
			);
		}
		return ret;
	}


var conf1 = [
		new Agent(0,0),
		new Agent(1,0),
		new Agent(0,1),
		new Agent(1,1)
];

	world.addAgentsToWorld(randStartConf(100,10),canvas);
	//world.addAgentsToWorld(conf1,canvas);

	// Set up a tick function that will move all satellites each frame

	var moveRandomly = function () {

		_.each(world.agents,function(agent) {
			if (agent!=null) {
					var xDiff = (Math.random()>.5) ,
						yDiff = 1- xDiff,
						sign = (Math.random()>.5) ?1:-1;

					world.moveAgent(xDiff*sign,yDiff*sign,agent);
				}
			}
		)
	};

	//canvas.setLoop(moveRandomly).start();
	canvas.setLoop(Simulation.GameOfLife_Step).start();

});

</script>
</head>


<body>

<textarea id = "input"></textarea>
<br/>
<input type="button" value="Process Input" onclick="processInput()"></input>
<br/>

<textarea id = "output"></textarea>

<br/><br/>

<canvas id="myCanvas"  width="500" height="500" >
</canvas>


</body>
</html>
